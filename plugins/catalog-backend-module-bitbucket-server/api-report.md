## API Report File for "@backstage/plugin-catalog-backend-module-bitbucket-server"

> Do not edit this file. It is a report generated by [API Extractor](https://api-extractor.com/).

```ts
import { BitbucketServerIntegrationConfig } from '@backstage/integration';
import { CatalogApi } from '@backstage/catalog-client';
import { Config } from '@backstage/config';
import { Entity } from '@backstage/catalog-model';
import { EntityProvider } from '@backstage/plugin-catalog-node';
import { EntityProviderConnection } from '@backstage/plugin-catalog-node';
import { EventParams } from '@backstage/plugin-events-node';
import { EventSubscriber } from '@backstage/plugin-events-node';
import { LocationSpec } from '@backstage/plugin-catalog-node';
import { Logger } from 'winston';
import { PluginTaskScheduler } from '@backstage/backend-tasks';
import { Response as Response_2 } from 'node-fetch';
import { TaskRunner } from '@backstage/backend-tasks';
import { TokenManager } from '@backstage/backend-common';

// @public
export class BitbucketServerClient {
  constructor(options: { config: BitbucketServerIntegrationConfig });
  // (undocumented)
  static fromConfig(options: {
    config: BitbucketServerIntegrationConfig;
  }): BitbucketServerClient;
  // (undocumented)
  getDefaultBranch(options: {
    projectKey: string;
    repo: string;
  }): Promise<BitbucketServerDefaultBranch>;
  // (undocumented)
  getFile(options: {
    projectKey: string;
    repo: string;
    path: string;
  }): Promise<Response_2>;
  // (undocumented)
  getRepository(options: {
    projectKey: string;
    repo: string;
  }): Promise<BitbucketServerRepository>;
  // (undocumented)
  listProjects(options: {
    listOptions?: BitbucketServerListOptions;
  }): Promise<BitbucketServerPagedResponse<BitbucketServerProject>>;
  // (undocumented)
  listRepositories(options: {
    projectKey: string;
    listOptions?: BitbucketServerListOptions;
  }): Promise<BitbucketServerPagedResponse<BitbucketServerRepository>>;
  // (undocumented)
  resolvePath(options: { projectKey: string; repo: string; path: string }): {
    path: string;
  };
}

// @public (undocumented)
export type BitbucketServerDefaultBranch = {
  id: string;
  displayId: string;
  type: string;
  latestCommit: string;
  latestChangeset: string;
  isDefault: boolean;
};

// @public
export class BitbucketServerEntityProvider
  implements EntityProvider, EventSubscriber
{
  // (undocumented)
  connect(connection: EntityProviderConnection): Promise<void>;
  // (undocumented)
  static fromConfig(
    config: Config,
    options: {
      logger: Logger;
      parser?: BitbucketServerLocationParser;
      schedule?: TaskRunner;
      scheduler?: PluginTaskScheduler;
      catalogApi?: CatalogApi;
      tokenManager?: TokenManager;
    },
  ): BitbucketServerEntityProvider[];
  // (undocumented)
  getProviderName(): string;
  // (undocumented)
  onEvent(params: EventParams): Promise<void>;
  onRepoPush(event: BitbucketServerEvents.RefsChangedEvent): Promise<void>;
  // (undocumented)
  refresh(logger: Logger): Promise<void>;
  // (undocumented)
  supportsEventTopics(): string[];
}

// @public (undocumented)
export namespace BitbucketServerEvents {
  // (undocumented)
  export type Actor = {
    name?: string;
    id: number;
  };
  // (undocumented)
  export type Change = {
    ref: {
      id: string;
      displayId: string;
      type: string;
    };
  };
  // (undocumented)
  export interface Event {
    // (undocumented)
    eventKey: string;
  }
  // (undocumented)
  export interface RefsChangedEvent extends Event {
    // (undocumented)
    actor: Actor;
    // (undocumented)
    changes: Change[];
    // (undocumented)
    commits: undefined;
    // (undocumented)
    date: string;
    // (undocumented)
    repository: Repository;
    // (undocumented)
    ToCommit: undefined;
  }
  // (undocumented)
  export type Repository = {
    slug: string;
    id: number;
    name: string;
    project: BitbucketServerProject;
  };
  {
  }
}

// @public (undocumented)
export type BitbucketServerListOptions = {
  [key: string]: number | undefined;
  limit?: number | undefined;
  start?: number | undefined;
};

// @public
export type BitbucketServerLocationParser = (options: {
  client: BitbucketServerClient;
  location: LocationSpec;
  logger: Logger;
}) => AsyncIterable<Entity>;

// @public (undocumented)
export type BitbucketServerPagedResponse<T> = {
  size: number;
  limit: number;
  start: number;
  isLastPage: boolean;
  values: T[];
  nextPageStart: number;
};

// @public (undocumented)
export type BitbucketServerProject = {
  key: string;
};

// @public (undocumented)
export type BitbucketServerRepository = {
  project: {
    key: string;
  };
  slug: string;
  description: string;
  links: Record<
    string,
    {
      href: string;
    }[]
  >;
  defaultBranch: string;
};

// @public (undocumented)
export function paginated(
  request: (
    options: BitbucketServerListOptions,
  ) => Promise<BitbucketServerPagedResponse<any>>,
  options?: BitbucketServerListOptions,
): AsyncGenerator<any, void, unknown>;
```
